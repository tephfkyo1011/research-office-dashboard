<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <title>๏ฟฝะบ๏ฟฝ๏ฟฝัด๏ฟฝ๏ฟฝรป๏ฟฝ๏ฟฝยป๏ฟฝะช๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝัน๏ฟฝ๏ฟฝ (Auto-Save)</title>
    <style>
        body { font-family: 'Sarabun', sans-serif; padding: 20px; background: #f0f2f5; color: #333; }
        .container { max-width: 900px; margin: 0 auto; background: white; padding: 30px; border-radius: 10px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); }
        h2 { color: #004a99; border-bottom: 2px solid #eee; padding-bottom: 15px; margin-top: 0; display: flex; align-items: center; gap: 10px; }
        .status-icon { font-size: 0.8rem; color: #28a745; font-weight: normal; margin-left: auto; display: none; }
        
        .form-group { margin-bottom: 25px; background: #fafafa; padding: 15px; border-radius: 8px; border: 1px solid #eee; }
        label { display: block; font-weight: bold; margin-bottom: 8px; font-size: 1.1rem; }
        textarea { width: 100%; padding: 10px; border: 1px solid #ccc; border-radius: 4px; font-size: 1rem; }
        
        table { width: 100%; border-collapse: collapse; margin-top: 10px; background: white; }
        th, td { border: 1px solid #ddd; padding: 12px; text-align: left; }
        th { background: #004a99; color: white; }
        
        input[type="text"], input[type="number"] { width: 100%; padding: 8px; border: 1px solid #ccc; border-radius: 4px; }
        
        .btn { padding: 8px 15px; cursor: pointer; border: none; border-radius: 4px; color: white; font-weight: bold; transition: 0.3s; }
        .btn:hover { opacity: 0.9; }
        .btn-green { background: #28a745; margin-top: 10px; font-size: 1rem; }
        .btn-red { background: #dc3545; }
        .btn-blue { background: #007bff; display: block; width: 100%; font-size: 1.3rem; padding: 15px; margin-top: 20px; }
        
        .note { color: #d9534f; font-size: 0.9rem; margin-top: 5px; }
        .drag-handle { cursor: default; text-align: center; color: #999; font-weight: bold; }
    </style>
</head>
<body>
    <div class="container">
        <h2>
            ??? ๏ฟฝะบ๏ฟฝ๏ฟฝัด๏ฟฝ๏ฟฝรป๏ฟฝ๏ฟฝยป๏ฟฝะช๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝัน๏ฟฝ๏ฟฝ 
            <span id="saveStatus" class="status-icon">? ๏ฟฝัน๏ฟฝึก๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ</span>
        </h2>

        <div class="form-group">
            <label>?? ๏ฟฝ๏ฟฝอค๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ (Ticker):</label>
            <textarea id="tickerInput" rows="3" placeholder="๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝอค๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ..." oninput="autoSave()"></textarea>
            <div class="note">* ๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ ๏ฟฝะบ๏ฟฝ๏ฟฝัน๏ฟฝึก๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝัต๏ฟฝ๏ฟฝัติทัน๏ฟฝ๏ฟฝ</div>
        </div>

        <div class="form-group">
            <label>??? ๏ฟฝ๏ฟฝยก๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ (Playlist):</label>
            <p class="note" style="margin-bottom: 10px;">* ๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝรง๏ฟฝับ๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ (๏ฟฝ๏ฟฝ image1.jpg, video.mp4)</p>
            
            <table id="playlistTable">
                <thead>
                    <tr>
                        <th style="width: 50px;">#</th>
                        <th style="width: 120px;">๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ</th>
                        <th>๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ (๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝสก๏ฟฝ๏ฟฝ)</th>
                        <th style="width: 100px;">๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ (๏ฟฝินาท๏ฟฝ)</th>
                        <th style="width: 80px;">ลบ</th>
                    </tr>
                </thead>
                <tbody>
                    </tbody>
            </table>
            <button class="btn btn-green" onclick="addRow()">+ ๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝยก๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ</button>
        </div>

        <hr>
        <button class="btn btn-blue" onclick="downloadFile()">?? ๏ฟฝ๏ฟฝวน๏ฟฝ๏ฟฝ๏ฟฝลด๏ฟฝ๏ฟฝ๏ฟฝ playlist.js (Download)</button>
        <p style="text-align: center; margin-top: 10px; color: #666;">๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝอต๏ฟฝอง๏ฟฝ๏ฟฝรนำข๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝิง (๏ฟฝ๏ฟฝ๏ฟฝะถูก๏ฟฝ๏ฟฝ๏ฟฝาง๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ)</p>
    </div>

    <script>
        // --- ๏ฟฝ๏ฟฝวน๏ฟฝำงาน๏ฟฝอง๏ฟฝะบ๏ฟฝ ---

        // 1. ๏ฟฝ๏ฟฝลด๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝาทัน๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝิดหน๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ
        window.onload = function() {
            loadFromMemory();
        }

        function loadFromMemory() {
            // ๏ฟฝึง๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝลต๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ
            const savedTicker = localStorage.getItem('smartBoard_ticker');
            if (savedTicker !== null) {
                document.getElementById('tickerInput').value = savedTicker;
            } else {
                document.getElementById('tickerInput').value = "๏ฟฝิน๏ฟฝีต๏ฟฝอน๏ฟฝับ๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝำนัก๏ฟฝาน...";
            }

            // ๏ฟฝึง๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝยก๏ฟฝ๏ฟฝ Playlist
            const savedList = localStorage.getItem('smartBoard_list');
            const tbody = document.getElementById('playlistTable').getElementsByTagName('tbody')[0];
            tbody.innerHTML = ''; // ๏ฟฝ๏ฟฝาง๏ฟฝ๏ฟฝ๏ฟฝาง๏ฟฝ๏ฟฝอน

            if (savedList) {
                const items = JSON.parse(savedList);
                items.forEach(item => {
                    // ๏ฟฝ่งค๏ฟฝ๏ฟฝ false ๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝัน๏ฟฝึก๏ฟฝ๏ฟฝำซ๏ฟฝอน๏ฟฝอน๏ฟฝ๏ฟฝลด
                    createRowElement(item.type, item.src, item.duration, false);
                });
            } else {
                // ๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ
                createRowElement('image', 'image1.jpg', 10, false);
            }
        }

        // ๏ฟฝัง๏ฟฝ๏ฟฝัน๏ฟฝ๏ฟฝ๏ฟฝาง๏ฟฝ๏ฟฝ (๏ฟฝยก๏ฟฝอก๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝยก๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ)
        function createRowElement(type = 'image', src = '', duration = '10', shouldSave = true) {
            const table = document.getElementById('playlistTable').getElementsByTagName('tbody')[0];
            const newRow = table.insertRow();
            
            newRow.innerHTML = `
                <td class="drag-handle"></td>
                <td>
                    <select class="type-select" style="width:100%; padding:5px;" onchange="autoSave()">
                        <option value="image" ${type==='image'?'selected':''}>๏ฟฝูป๏ฟฝาพ</option>
                        <option value="video" ${type==='video'?'selected':''}>๏ฟฝิด๏ฟฝ๏ฟฝ๏ฟฝ</option>
                    </select>
                </td>
                <td><input type="text" class="src-input" value="${src}" placeholder="๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ..." oninput="autoSave()"></td>
                <td><input type="number" class="dur-input" value="${duration}" oninput="autoSave()"></td>
                <td><button class="btn btn-red" onclick="deleteRow(this)">ลบ</button></td>
            `;

            updateRowNumbers();
            if(shouldSave) autoSave();
        }

        // ๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝยก๏ฟฝ๏ฟฝ
        function addRow() {
            createRowElement('image', '', '10', true);
        }

        function deleteRow(btn) {
            if(confirm('๏ฟฝ๏ฟฝอง๏ฟฝ๏ฟฝ๏ฟฝลบ๏ฟฝ๏ฟฝยก๏ฟฝรน๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ?')) {
                const row = btn.parentNode.parentNode;
                row.parentNode.removeChild(row);
                updateRowNumbers();
                autoSave(); // ลบ๏ฟฝ๏ฟฝ๏ฟฝวบัน๏ฟฝึก๏ฟฝัน๏ฟฝ๏ฟฝ
            }
        }

        function updateRowNumbers() {
            const rows = document.querySelectorAll('#playlistTable tbody tr');
            rows.forEach((r, i) => r.cells[0].innerText = i + 1);
        }

        // --- ๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝัก: ๏ฟฝัง๏ฟฝ๏ฟฝัน๏ฟฝัน๏ฟฝึก๏ฟฝัต๏ฟฝ๏ฟฝัต๏ฟฝ (Auto-Save) ---
        function autoSave() {
            // 1. ๏ฟฝ็บข๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝลต๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ
            const ticker = document.getElementById('tickerInput').value;
            localStorage.setItem('smartBoard_ticker', ticker);

            // 2. ๏ฟฝ็บข๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ Playlist
            const rows = document.querySelectorAll('#playlistTable tbody tr');
            let dataToSave = [];

            rows.forEach(row => {
                const type = row.querySelector('.type-select').value;
                const src = row.querySelector('.src-input').value; // ๏ฟฝัน๏ฟฝึก๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ็นค๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝาง
                const duration = row.querySelector('.dur-input').value;
                
                dataToSave.push({ type, src, duration });
            });

            localStorage.setItem('smartBoard_list', JSON.stringify(dataToSave));

            // ๏ฟฝสด๏ฟฝสถาน๏ฟฝ๏ฟฝ๏ฟฝาบัน๏ฟฝึก๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ
            const status = document.getElementById('saveStatus');
            status.style.display = 'inline';
            setTimeout(() => { status.style.display = 'none'; }, 1000);
        }

        // --- ๏ฟฝัง๏ฟฝ๏ฟฝัน๏ฟฝ๏ฟฝวน๏ฟฝ๏ฟฝ๏ฟฝลด๏ฟฝ๏ฟฝ๏ฟฝ (๏ฟฝยก๏ฟฝาก๏ฟฝ๏ฟฝรบัน๏ฟฝึก) ---
        function downloadFile() {
            const ticker = document.getElementById('tickerInput').value.replace(/\n/g, " ");
            const rows = document.querySelectorAll('#playlistTable tbody tr');
            let jsContentList = [];

            rows.forEach(row => {
                const type = row.query
