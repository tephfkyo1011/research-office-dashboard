<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Research Office Portal</title>


<link href="https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;500;600&family=Sarabun:wght@300;400&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">


<style>
:root {
--primary-grad: linear-gradient(135deg, #0f2027 0%, #203a43 50%, #2c5364 100%);
--bg-color: #f4f6f9;
--card-bg: #ffffff;
--text-main: #2c3e50;
--text-sub: #6c757d;
--gold: #ffc107;


--col-it: #007bff;
--col-hr: #e83e8c;
--col-admin: #fd7e14;
--col-central: #20c997;
--col-fun: #6f42c1;
}


* { box-sizing: border-box; }
body {
font-family: 'Sarabun', sans-serif;
background-color: var(--bg-color);
margin: 0;
padding-bottom: 40px;
}


header {
background: var(--primary-grad);
padding: 30px 20px 70px;
text-align: center;
color: white;
border-bottom-left-radius: 30px;
border-bottom-right-radius: 30px;
box-shadow: 0 10px 20px rgba(0,0,0,0.15);
}
h1 { font-family: 'Prompt', sans-serif; font-size: 1.6rem; margin: 0; }
p.subtitle { font-size: 0.85rem; opacity: .9; }


.search-wrapper {
position: sticky;
top: 15px;
z-index: 100;
padding: 0 15px;
margin-top: -45px;
}
.search-box {
width: 100%;
padding: 15px 20px;
border-radius: 30px;
border: none;
box-shadow: 0 8px 25px rgba(0,0,0,.1);
font-family: 'Prompt', sans-serif;
font-size: 1rem;
}


.container {
padding: 20px 15px;
max-width: 900px;
margin: auto;
}


.notice {
background: #fff3cd;
color: #856404;
border: 1px solid #ffeeba;
padding: 15px;
border-radius: 15px;
margin-bottom: 25px;
text-align: center;
font-size: .85rem;
}


.section-title {
font-family: 'Prompt', sans-serif;
font-size: 1.2rem;
</div>

        <div class="section-title"><i class="fa-solid fa-laptop-medical"></i> IT & ครุภัณฑ์</div>
        <div class="grid cat-it" data-section="it ไอที คอมพิวเตอร์ ครุภัณฑ์ system hardware software">
            <a href="https://www.appsheet.com/start/54d31000-2358-4abc-bd52-44472a9275c6?platform=desktop#appName=NewApp-454736422" 
               target="_blank" rel="noopener" class="card" data-name="User ครุภัณฑ์">
                <div class="pin" onclick="togglePin(event, this.parentNode)">★</div>
                <div class="icon-circle"><i class="fa-solid fa-boxes-stacked"></i></div>
                <div class="card-title">User ครุภัณฑ์</div>
                <div class="card-desc">AppSheet ระบบครุภัณฑ์</div>
            </a>
            <a href="http://10.6.22.52/ramapro/index.php?ret_link=%2Framapro%2Fdefault.php&type=notLogged" 
               target="_blank" rel="noopener" class="card" data-name="แจ้งซ่อม">
                <span class="badge-lan">LAN</span>
                <div class="pin" onclick="togglePin(event, this.parentNode)">★</div>
                <div class="icon-circle"><i class="fa-solid fa-screwdriver-wrench"></i></div>
                <div class="card-title">แจ้งซ่อม (ESD)</div>
                <div class="card-desc">วิศวกรรมบริการ</div>
            </a>
            <a href="http://intranet.rama.mahidol.ac.th/MI/Materials/list.htm" 
               target="_blank" rel="noopener" class="card" data-name="วัสดุคอมพิวเตอร์">
                <span class="badge-lan">LAN</span>
                <div class="pin" onclick="togglePin(event, this.parentNode)">★</div>
                <div class="icon-circle"><i class="fa-solid fa-print"></i></div>
                <div class="card-title">วัสดุคอมพิวเตอร์</div>
                <div class="card-desc">หมึกพิมพ์/อุปกรณ์</div>
            </a>
            <a href="https://docs.google.com/spreadsheets/d/19i4hVR8ZRbuoAjNNxV6wWfn8wj9_u66UAXQbSv1JOyA/edit?gid=872930443#gid=872930443" 
               target="_blank" rel="noopener" class="card" data-name="ข้อมูลแอร์">
                <div class="pin" onclick="togglePin(event, this.parentNode)">★</div>
                <div class="icon-circle"><i class="fa-solid fa-fan"></i></div>
                <div class="card-title">ข้อมูลแอร์</div>
                <div class="card-desc">รายละเอียดแอร์</div>
            </a>
            <a href="https://script.google.com/macros/s/AKfycbwSpX9iDz1wWLjQfNyJbWLfreGyHDl0vYasnF27DhiyLnYz8UZs7aZfz9ct5fNTKH-m/exec" 
               target="_blank" rel="noopener" class="card" data-name="ระบบแก๊ส">
                <div class="pin" onclick="togglePin(event, this.parentNode)">★</div>
                <div class="icon-circle"><i class="fa-solid fa-fire-burner"></i></div>
                <div class="card-title">ระบบแก๊ส & Stock</div>
                <div class="card-desc">จัดการแก๊ส</div>
            </a>
            <a href="https://www.appsheet.com/start/6e4cdc1f-da32-4ae1-87c6-3e7a0d81929f?platform=desktop" 
               target="_blank" rel="noopener" class="card" data-name="ฐานข้อมูลครุภัณฑ์">
                <div class="pin" onclick="togglePin(event, this.parentNode)">★</div>
                <div class="icon-circle"><i class="fa-solid fa-database"></i></div>
                <div class="card-title">ฐานข้อมูลครุภัณฑ์</div>
                <div class="card-desc">Digital Assets</div>
            </a>
            <a href="https://script.google.com/macros/s/AKfycbwYbLgv2hYbwSgsy4G2yC9EUBoHXmOkOvEPHTjEldz6BvJeW8wYv4KyfwSyJNpdm96u/exec" 
               target="_blank" rel="noopener" class="card" data-name="Dashboard">
                <div class="pin" onclick="togglePin(event, this.parentNode)">★</div>
                <div class="icon-circle"><i class="fa-solid fa-chart-pie"></i></div>
                <div class="card-title">Dashboard</div>
                <div class="card-desc">สรุปข้อมูลครุภัณฑ์</div>
            </a>
            <a href="https://10-6-155-150.rcnas1838.direct.quickconnect.to:9443/#/signin" 
               target="_blank" rel="noopener" class="card" data-name="NAS Synology">
                <div class="pin" onclick="togglePin(event, this.parentNode)">★</div>
                <div class="icon-circle"><i class="fa-solid fa-server"></i></div>
                <div class="card-title">NAS Synology</div>
                <div class="card-desc">QuickConnect</div>
            </a>
            <a href="https://softwaredownload.mahidol.ac.th/" 
               target="_blank" rel="noopener" class="card" data-name="โหลดโปรแกรม">
                <div class="pin" onclick="togglePin(event, this.parentNode)">★</div>
                <div class="icon-circle"><i class="fa-brands fa-windows"></i></div>
                <div class="card-title">โหลดโปรแกรม</div>
                <div class="card-desc">Software Download</div>
            </a>
            <a href="http://192.168.1.150/" 
               target="_blank" rel="noopener" class="card" data-name="XWEB อุณหภูมิ">
                <span class="badge-lan">LAN</span>
                <div class="pin" onclick="togglePin(event, this.parentNode)">★</div>
                <div class="icon-circle"><i class="fa-solid fa-temperature-high"></i></div>
                <div class="card-title">XWEB อุณหภูมิ</div>
                <div class="card-desc">เช็คอุณหภูมิ</div>
            </a>
        </div>

        <div class="section-title"><i class="fa-solid fa-users"></i> HR & บุคลากร</div>
        <div class="grid cat-hr" data-section="hr บุคลากร person human workforce ลา ot สวัสดิการ">
            <a href="http://n-rfid.rama.mahidol.ac.th/Time/Login" 
               target="_blank" rel="noopener" class="card" data-name="ตอกบัตร">
                <span class="badge-lan">LAN</span>
                <div class="pin" onclick="togglePin(event, this.parentNode)">★</div>
                <div class="icon-circle"><i class="fa-solid fa-id-card-clip"></i></div>
                <div class="card-title">ตอกบัตรเข้า-ออก</div>
                <div class="card-desc">ระบบ RFID</div>
            </a>
            <a href="https://www3.ra.mahidol.ac.th/leaveRama/index.jsp" 
               target="_blank" rel="noopener" class="card" data-name="ลาออนไลน์">
                <div class="pin" onclick="togglePin(event, this.parentNode)">★</div>
                <div class="icon-circle"><i class="fa-solid fa-business-time"></i></div>
                <div class="card-title">ลาออนไลน์</div>
                <div class="card-desc">ระบบลา คณะฯ</div>
            </a>
            <a href="https://script.google.com/macros/s/AKfycbzO_77wN89GjfbaoqkcH_j9iziyK-_mbKP_8PGnUuvPOsnjkyx2HZWo1naZJWwuuo8wVg/exec" 
               target="_blank" rel="noopener" class="card" data-name="ลงเวลานอกราชการ">
                <div class="pin" onclick="togglePin(event, this.parentNode)">★</div>
                <div class="icon-circle"><i class="fa-regular fa-clock"></i></div>
                <div class="card-title">ลงเวลานอกราชการ</div>
                <div class="card-desc">OT สนง.วิจัย</div>
            </a>
            <a href="https://intra9.rama.mahidol.ac.th/hc/" 
               target="_blank" rel="noopener" class="card" data-name="บริหารทุนมนุษย์">
                <span class="badge-lan">LAN</span>
                <div class="pin" onclick="togglePin(event, this.parentNode)">★</div>
                <div class="icon-circle"><i class="fa-solid fa-user-tie"></i></div>
                <div class="card-title">บริหารทุนมนุษย์</div>
                <div class="card-desc">HR คณะฯ</div>
            </a>
            <a href="https://idp.mahidol.ac.th/adfs/oauth2/authorize/?client_id=c3dd06c3-cd83-4783-a570-38232c6ce67d" 
               target="_blank" rel="noopener" class="card" data-name="Flexible Benefit">
                <div class="pin" onclick="togglePin(event, this.parentNode)">★</div>
                <div class="icon-circle"><i class="fa-solid fa-hand-holding-heart"></i></div>
                <div class="card-title">Flexible Benefit</div>
                <div class="card-desc">สวัสดิการมหิดล</div>
            </a>
            <a href="https://www.si.mahidol.ac.th/musaving/index.asp" 
               target="_blank" rel="noopener" class="card" data-name="สหกรณ์ออมทรัพย์">
                <div class="pin" onclick="togglePin(event, this.parentNode)">★</div>
                <div class="icon-circle"><i class="fa-solid fa-piggy-bank"></i></div>
                <div class="card-title">สหกรณ์ออมทรัพย์</div>
                <div class="card-desc">มหิดล</div>
            </a>
            <a href="https://script.google.com/macros/s/AKfycbxuLfi1MDq-TO5cU68KfeR1SLvL2TmIjS296nxbyMGpqcd1yJMqMiEtwbmga2A4PBVT/exec" 
               target="_blank" rel="noopener" class="card" data-name="ค่ารักษาพยาบาล">
                <div class="pin" onclick="togglePin(event, this.parentNode)">★</div>
                <div class="icon-circle"><i class="fa-solid fa-file-invoice-dollar"></i></div>
                <div class="card-title">ค่ารักษาพยาบาล</div>
                <div class="card-desc">ครอบครัว</div>
            </a>
        </div>

        <div class="section-title"><i class="fa-solid fa-building"></i> ธุรการ & ทั่วไป</div>
        <div class="grid cat-admin" data-section="ธุรการ admin office อาคาร ห้องประชุม พัสดุ general">
            <a href="http://10.6.155.94/RAI/index.php" 
               target="_blank" rel="noopener" class="card" data-name="จองห้องประชุม">
                <span class="badge-lan">LAN</span>
                <div class="pin" onclick="togglePin(event, this.parentNode)">★</div>
                <div class="icon-circle"><i class="fa-solid fa-calendar-check"></i></div>
                <div class="card-title">จองห้องประชุม</div>
                <div class="card-desc">RC Meeting</div>
            </a>
            <a href="https://script.google.com/macros/s/AKfycbxprHKO3pzWfYU9oZ2cQl-ynTWTzUp8P8LY3Ens7WwP8mS1k4amv6hLnRhq2C2jb9YN/exec" 
               target="_blank" rel="noopener" class="card" data-name="Phone Book">
                <div class="pin" onclick="togglePin(event, this.parentNode)">★</div>
                <div class="icon-circle"><i class="fa-solid fa-phone-volume"></i></div>
                <div class="card-title">Phone Book</div>
                <div class="card-desc">เบอร์ภายใน</div>
            </a>
            <a href="https://sites.google.com/view/rc-rama" 
               target="_blank" rel="noopener" class="card" data-name="ธุรการทั่วไป">
                <div class="pin" onclick="togglePin(event, this.parentNode)">★</div>
                <div class="icon-circle"><i class="fa-solid fa-folder-open"></i></div>
                <div class="card-title">ธุรการทั่วไป</div>
                <div class="card-desc">RC-Rama Site</div>
            </a>
            <a href="https://docs.google.com/spreadsheets/d/1RKZ_2ovlxldT9m5HT7StiVaYxyoQvM4T/edit?gid=176877453#gid=176877453" 
               target="_blank" rel="noopener" class="card" data-name="กุญแจห้อง">
                <div class="pin" onclick="togglePin(event, this.parentNode)">★</div>
                <div class="icon-circle"><i class="fa-solid fa-key"></i></div>
                <div class="card-title">กุญแจห้อง</div>
                <div class="card-desc">อาคารวิจัย</div>
            </a>
            <a href="https://docs.google.com/forms/d/e/1FAIpQLScYM8hJbXEhOFuXlU0zet2dqHfX8dSqLjcBNKSov0BMgnbPLQ/viewform" 
               target="_blank" rel="noopener" class="card" data-name="Check List">
                <div class="pin" onclick="togglePin(event, this.parentNode)">★</div>
                <div class="icon-circle"><i class="fa-solid fa-list-check"></i></div>
                <div class="card-title">Check List</div>
                <div class="card-desc">แบบฟอร์ม</div>
            </a>
            <a href="https://script.google.com/macros/s/AKfycbymVbym9Xf6_9xgHWtl-DdVKGCJ6NQra7j9UcSOilKrThNYs7PKHLKbzrQwyYLDy-J2_A/exec" 
               target="_blank" rel="noopener" class="card" data-name="Liquid Nitrogen">
                <div class="pin" onclick="togglePin(event, this.parentNode)">★</div>
                <div class="icon-circle"><i class="fa-solid fa-snowflake"></i></div>
                <div class="card-title">Liquid Nitrogen</div>
                <div class="card-desc">รับ-ส่ง</div>
            </a>
            <a href="https://docs.google.com/forms/d/e/1FAIpQLSfvbmmBQiKiBhxSI15sjVilYxFuxHhc5S1i8IFnir9jzAtvGw/viewform" 
               target="_blank" rel="noopener" class="card" data-name="ขอขนย้ายของ">
                <div class="pin" onclick="togglePin(event, this.parentNode)">★</div>
                <div class="icon-circle"><i class="fa-solid fa-truck-ramp-box"></i></div>
                <div class="card-title">ขอขนย้ายของ</div>
                <div class="card-desc">แบบฟอร์ม</div>
            </a>
            <a href="http://10.6.155.38/" 
               target="_blank" rel="noopener" class="card" data-name="ประตูหน้า">
                <span class="badge-lan">LAN</span>
                <div class="pin" onclick="togglePin(event, this.parentNode)">★</div>
                <div class="icon-circle"><i class="fa-solid fa-door-open"></i></div>
                <div class="card-title">ประตูหน้า (38)</div>
                <div class="card-desc">เข้า-ออก สนง.</div>
            </a>
            <a href="http://10.6.155.225/" 
               target="_blank" rel="noopener" class="card" data-name="ประตู LAB 225">
                <span class="badge-lan">LAN</span>
                <div class="pin" onclick="togglePin(event, this.parentNode)">★</div>
                <div class="icon-circle"><i class="fa-solid fa-flask"></i></div>
                <div class="card-title">ประตู LAB 225</div>
                <div class="card-desc">เข้า-ออก LAB</div>
            </a>
            <a href="http://10.6.155.226/" 
               target="_blank" rel="noopener" class="card" data-name="ประตู LAB 226">
                <span class="badge-lan">LAN</span>
                <div class="pin" onclick="togglePin(event, this.parentNode)">★</div>
                <div class="icon-circle"><i class="fa-solid fa-flask-vial"></i></div>
                <div class="card-title">ประตู LAB 226</div>
                <div class="card-desc">เข้า-ออก LAB</div>
            </a>
            <a href="https://www.appsheet.com/start/2e8cd042-246d-4b55-abb8-a5884ba0c60d?platform=desktop" 
               target="_blank" rel="noopener" class="card" data-name="Specimen Bank">
                <div class="pin" onclick="togglePin(event, this.parentNode)">★</div>
                <div class="icon-circle"><i class="fa-solid fa-vial"></i></div>
                <div class="card-title">Specimen Bank</div>
                <div class="card-desc">HSR Banking</div>
            </a>
            <a href="https://intra9.rama.mahidol.ac.th/inventory/th/miniecat/miniecatbook" 
               target="_blank" rel="noopener" class="card" data-name="Mini Ecat Book">
                <span class="badge-lan">LAN</span>
                <div class="pin" onclick="togglePin(event, this.parentNode)">★</div>
                <div class="icon-circle"><i class="fa-solid fa-book"></i></div>
                <div class="card-title">Mini Ecat Book</div>
                <div class="card-desc">ระบบพัสดุ</div>
            </a>
        </div>

        <div class="section-title"><i class="fa-solid fa-globe"></i> ส่วนกลาง</div>
        <div class="grid cat-central" data-section="ส่วนกลาง central hospital university ระบบกลาง mahidol">
            <a href="https://www.rama.mahidol.ac.th/research/th" 
               target="_blank" rel="noopener" class="card" data-name="เว็บ สนง.วิจัย">
                <div class="pin" onclick="togglePin(event, this.parentNode)">★</div>
                <div class="icon-circle"><i class="fa-solid fa-sitemap"></i></div>
                <div class="card-title">เว็บ สนง.วิจัย</div>
                <div class="card-desc">Official Web</div>
            </a>
            <a href="https://intra9.rama.mahidol.ac.th/online_requests" 
               target="_blank" rel="noopener" class="card" data-name="บริการออนไลน์ รพ.">
                <span class="badge-lan">LAN</span>
                <div class="pin" onclick="togglePin(event, this.parentNode)">★</div>
                <div class="icon-circle"><i class="fa-solid fa-computer-mouse"></i></div>
                <div class="card-title">บริการออนไลน์ รพ.</div>
                <div class="card-desc">Online Requests</div>
            </a>
            <a href="https://myinternet.mahidol.ac.th/" 
               target="_blank" rel="noopener" class="card" data-name="MyInternet">
                <div class="pin" onclick="togglePin(event, this.parentNode)">★</div>
                <div class="icon-circle"><i class="fa-solid fa-wifi"></i></div>
                <div class="card-title">MyInternet</div>
                <div class="card-desc">เน็ตมหิดล</div>
            </a>
            <a href="https://intra9.rama.mahidol.ac.th/rama/office" 
               target="_blank" rel="noopener" class="card" data-name="หน่วยงานใน รพ.">
                <span class="badge-lan">LAN</span>
                <div class="pin" onclick="togglePin(event, this.parentNode)">★</div>
                <div class="icon-circle"><i class="fa-solid fa-hospital"></i></div>
                <div class="card-title">หน่วยงานใน รพ.</div>
                <div class="card-desc">รายชื่อหน่วยงาน</div>
            </a>
        </div>

        <div class="section-title"><i class="fa-solid fa-gamepad"></i> บันเทิง (By KYO GI)</div>
        <div class="grid cat-fun" data-section="บันเทิง fun entertainment relax movie หวย game">
            <a href="https://www.appsheet.com/start/5a0dbaf8-5f2f-43c4-8b1a-482728632309?platform=desktop" 
               target="_blank" rel="noopener" class="card" data-name="Movie Anime">
                <div class="pin" onclick="togglePin(event, this.parentNode)">★</div>
                <div class="icon-circle"><i class="fa-solid fa-film"></i></div>
                <div class="card-title">Movie Anime</div>
                <div class="card-desc">APP ดูหนัง/ซีรีย์</div>
            </a>
            <a href="https://script.google.com/a/macros/mahidol.ac.th/s/AKfycbws9LKwF_WssZCVV5x_dK1xkGRy3_Cecpz7MGPDi4uLJ7d22OgNIsJjbaDrBtZOfYv8vA/exec" 
               target="_blank" rel="noopener" class="card" data-name="เลขพารวย">
                <div class="pin" onclick="togglePin(event, this.parentNode)">★</div>
                <div class="icon-circle"><i class="fa-solid fa-ticket"></i></div>
                <div class="card-title">เลขพารวย Pro</div>
                <div class="card-desc">ลุ้นโชค</div>
            </a>
        </div>

    </div>

    <div class="footer">
        © 2024 Research Office Portal<br>Created by KYO GI
    </div>

    <script>
        // 1. Search Logic (เพิ่มการค้นหาจาก sectionData)
        const searchInput = document.getElementById('searchInput');
        const cards = document.querySelectorAll('.card');

        searchInput.addEventListener('keyup', (e) => {
            const term = e.target.value.toLowerCase();
            cards.forEach(card => {
                const title = card.querySelector('.card-title').innerText.toLowerCase();
                const desc = card.querySelector('.card-desc').innerText.toLowerCase();
                const nameData = card.dataset.name ? card.dataset.name.toLowerCase() : '';
                
                // ดึง keywords จาก data-section ของ div.grid ที่ครอบอยู่
                const sectionData = card.closest('.grid')?.dataset.section?.toLowerCase() || '';
                
                // เพิ่ม sectionData ในเงื่อนไข
                if(title.includes(term) || desc.includes(term) || nameData.includes(term) || sectionData.includes(term)) {
                    card.style.display = 'flex';
                } else {
                    card.style.display = 'none';
                }
            });
        });

        // 2. Pin Logic
        function togglePin(event, card) {
            event.preventDefault(); 
            event.stopPropagation();

            const cardName = card.dataset.name;
            if(!cardName) return; 

            card.classList.toggle('pinned');
            
            let pinnedItems = JSON.parse(localStorage.getItem('pinnedCards')) || [];
            
            if (card.classList.contains('pinned')) {
                if (!pinnedItems.includes(cardName)) {
                    pinnedItems.push(cardName);
                }
            } else {
                pinnedItems = pinnedItems.filter(item => item !== cardName);
            }
            localStorage.setItem('pinnedCards', JSON.stringify(pinnedItems));
        }

        function loadPins() {
            const pinnedItems = JSON.parse(localStorage.getItem('pinnedCards')) || [];
            cards.forEach(card => {
                if (pinnedItems.includes(card.dataset.name)) {
                    card.classList.add('pinned');
                }
            });
            sortCards(); 
        }

        function sortCards() {
            const grids = document.querySelectorAll('.grid');
            grids.forEach(grid => {
                const items = Array.from(grid.children);
                items.sort((a, b) => {
                    const aPinned = a.classList.contains('pinned');
                    const bPinned = b.classList.contains('pinned');
                    return bPinned - aPinned; // Pinned มาก่อน
                });
                items.forEach(item => grid.appendChild(item));
            });
        }

        // Run on load
        window.addEventListener('DOMContentLoaded', loadPins);
    </script>

</body>
</html>
