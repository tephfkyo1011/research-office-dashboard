<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <title>‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏õ‡πâ‡∏≤‡∏¢‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå (Auto-Save)</title>
    <style>
        body { font-family: 'Sarabun', sans-serif; padding: 20px; background: #f0f2f5; color: #333; }
        .container { max-width: 900px; margin: 0 auto; background: white; padding: 30px; border-radius: 10px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); }
        h2 { color: #004a99; border-bottom: 2px solid #eee; padding-bottom: 15px; margin-top: 0; display: flex; align-items: center; gap: 10px; }
        .status-icon { font-size: 0.8rem; color: #28a745; font-weight: normal; margin-left: auto; display: none; }
        
        .form-group { margin-bottom: 25px; background: #fafafa; padding: 15px; border-radius: 8px; border: 1px solid #eee; }
        label { display: block; font-weight: bold; margin-bottom: 8px; font-size: 1.1rem; }
        textarea { width: 100%; padding: 10px; border: 1px solid #ccc; border-radius: 4px; font-size: 1rem; }
        
        table { width: 100%; border-collapse: collapse; margin-top: 10px; background: white; }
        th, td { border: 1px solid #ddd; padding: 12px; text-align: left; }
        th { background: #004a99; color: white; }
        
        input[type="text"], input[type="number"] { width: 100%; padding: 8px; border: 1px solid #ccc; border-radius: 4px; }
        
        .btn { padding: 8px 15px; cursor: pointer; border: none; border-radius: 4px; color: white; font-weight: bold; transition: 0.3s; }
        .btn:hover { opacity: 0.9; }
        .btn-green { background: #28a745; margin-top: 10px; font-size: 1rem; }
        .btn-red { background: #dc3545; }
        .btn-blue { background: #007bff; display: block; width: 100%; font-size: 1.3rem; padding: 15px; margin-top: 20px; }
        
        .note { color: #d9534f; font-size: 0.9rem; margin-top: 5px; }
        .drag-handle { cursor: default; text-align: center; color: #999; font-weight: bold; }
    </style>
</head>
<body>
    <div class="container">
        <h2>
            üéõÔ∏è ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏õ‡πâ‡∏≤‡∏¢‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå 
            <span id="saveStatus" class="status-icon">‚úÖ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÅ‡∏•‡πâ‡∏ß</span>
        </h2>

        <div class="form-group">
            <label>üì¢ ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡∏±‡∏ß‡∏ß‡∏¥‡πà‡∏á (Ticker):</label>
            <textarea id="tickerInput" rows="3" placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà..." oninput="autoSave()"></textarea>
            <div class="note">* ‡∏û‡∏¥‡∏°‡∏û‡πå‡∏õ‡∏∏‡πä‡∏ö ‡∏£‡∏∞‡∏ö‡∏ö‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÉ‡∏´‡πâ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥‡∏ó‡∏±‡∏ô‡∏ó‡∏µ</div>
        </div>

        <div class="form-group">
            <label>üñºÔ∏è ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏∑‡πà‡∏≠ (Playlist):</label>
            <p class="note" style="margin-bottom: 10px;">* ‡πÉ‡∏™‡πà‡∏ä‡∏∑‡πà‡∏≠‡πÑ‡∏ü‡∏•‡πå‡πÉ‡∏´‡πâ‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡πÑ‡∏ü‡∏•‡πå‡πÉ‡∏ô‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå (‡πÄ‡∏ä‡πà‡∏ô image1.jpg, video.mp4)</p>
            
            <table id="playlistTable">
                <thead>
                    <tr>
                        <th style="width: 50px;">#</th>
                        <th style="width: 120px;">‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó</th>
                        <th>‡∏ä‡∏∑‡πà‡∏≠‡πÑ‡∏ü‡∏•‡πå (‡∏£‡∏ß‡∏°‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•)</th>
                        <th style="width: 100px;">‡πÄ‡∏ß‡∏•‡∏≤ (‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ)</th>
                        <th style="width: 80px;">‡∏•‡∏ö</th>
                    </tr>
                </thead>
                <tbody>
                    </tbody>
            </table>
            <button class="btn btn-green" onclick="addRow()">+ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡∏°‡πà</button>
        </div>

        <hr>
        <button class="btn btn-blue" onclick="downloadFile()">üíæ ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ü‡∏•‡πå playlist.js (Download)</button>
        <p style="text-align: center; margin-top: 10px; color: #666;">‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏°‡∏ô‡∏µ‡πâ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏ô‡∏≥‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏õ‡πÉ‡∏ä‡πâ‡∏à‡∏£‡∏¥‡∏á (‡πÑ‡∏ü‡∏•‡πå‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÉ‡∏´‡∏°‡πà)</p>
    </div>

    <script>
        // --- ‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á‡∏£‡∏∞‡∏ö‡∏ö ---

        // 1. ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏Å‡πà‡∏≤‡∏ó‡∏±‡∏ô‡∏ó‡∏µ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡∏¥‡∏î‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö
        window.onload = function() {
            loadFromMemory();
        }

        function loadFromMemory() {
            // ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏±‡∏ß‡∏ß‡∏¥‡πà‡∏á
            const savedTicker = localStorage.getItem('smartBoard_ticker');
            if (savedTicker !== null) {
                document.getElementById('tickerInput').value = savedTicker;
            } else {
                document.getElementById('tickerInput').value = "‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏ï‡πâ‡∏≠‡∏ô‡∏£‡∏±‡∏ö‡∏™‡∏π‡πà‡∏™‡∏≥‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô...";
            }

            // ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ Playlist
            const savedList = localStorage.getItem('smartBoard_list');
            const tbody = document.getElementById('playlistTable').getElementsByTagName('tbody')[0];
            tbody.innerHTML = ''; // ‡∏•‡πâ‡∏≤‡∏á‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏Å‡πà‡∏≠‡∏ô

            if (savedList) {
                const items = JSON.parse(savedList);
                items.forEach(item => {
                    // ‡∏™‡πà‡∏á‡∏Ñ‡πà‡∏≤ false ‡πÑ‡∏õ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ã‡πâ‡∏≥‡∏ã‡πâ‡∏≠‡∏ô‡∏ï‡∏≠‡∏ô‡πÇ‡∏´‡∏•‡∏î
                    createRowElement(item.type, item.src, item.duration, false);
                });
            } else {
                // ‡∏Ñ‡πà‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô
                createRowElement('image', 'image1.jpg', 10, false);
            }
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÅ‡∏ñ‡∏ß (‡πÅ‡∏¢‡∏Å‡∏≠‡∏≠‡∏Å‡∏°‡∏≤‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÉ‡∏ä‡πâ‡πÑ‡∏î‡πâ‡∏á‡πà‡∏≤‡∏¢)
        function createRowElement(type = 'image', src = '', duration = '10', shouldSave = true) {
            const table = document.getElementById('playlistTable').getElementsByTagName('tbody')[0];
            const newRow = table.insertRow();
            
            newRow.innerHTML = `
                <td class="drag-handle"></td>
                <td>
                    <select class="type-select" style="width:100%; padding:5px;" onchange="autoSave()">
                        <option value="image" ${type==='image'?'selected':''}>‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û</option>
                        <option value="video" ${type==='video'?'selected':''}>‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠</option>
                    </select>
                </td>
                <td><input type="text" class="src-input" value="${src}" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡πÑ‡∏ü‡∏•‡πå..." oninput="autoSave()"></td>
                <td><input type="number" class="dur-input" value="${duration}" oninput="autoSave()"></td>
                <td><button class="btn btn-red" onclick="deleteRow(this)">‡∏•‡∏ö</button></td>
            `;

            updateRowNumbers();
            if(shouldSave) autoSave();
        }

        // ‡∏õ‡∏∏‡πà‡∏°‡∏Å‡∏î‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£
        function addRow() {
            createRowElement('image', '', '10', true);
        }

        function deleteRow(btn) {
            if(confirm('‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ô‡∏µ‡πâ‡πÉ‡∏ä‡πà‡πÑ‡∏´‡∏°?')) {
                const row = btn.parentNode.parentNode;
                row.parentNode.removeChild(row);
                updateRowNumbers();
                autoSave(); // ‡∏•‡∏ö‡πÅ‡∏•‡πâ‡∏ß‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ó‡∏±‡∏ô‡∏ó‡∏µ
            }
        }

        function updateRowNumbers() {
            const rows = document.querySelectorAll('#playlistTable tbody tr');
            rows.forEach((r, i) => r.cells[0].innerText = i + 1);
        }

        // --- ‡∏´‡∏±‡∏ß‡πÉ‡∏à‡∏´‡∏•‡∏±‡∏Å: ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥ (Auto-Save) ---
        function autoSave() {
            // 1. ‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏±‡∏ß‡∏ß‡∏¥‡πà‡∏á
            const ticker = document.getElementById('tickerInput').value;
            localStorage.setItem('smartBoard_ticker', ticker);

            // 2. ‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Playlist
            const rows = document.querySelectorAll('#playlistTable tbody tr');
            let dataToSave = [];

            rows.forEach(row => {
                const type = row.querySelector('.type-select').value;
                const src = row.querySelector('.src-input').value; // ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏´‡∏°‡∏î‡πÅ‡∏°‡πâ‡∏à‡∏∞‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡πà‡∏≤‡∏ß‡πà‡∏≤‡∏á
                const duration = row.querySelector('.dur-input').value;
                
                dataToSave.push({ type, src, duration });
            });

            localStorage.setItem('smartBoard_list', JSON.stringify(dataToSave));

            // ‡πÅ‡∏™‡∏î‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏ß‡πà‡∏≤‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÅ‡∏•‡πâ‡∏ß
            const status = document.getElementById('saveStatus');
            status.style.display = 'inline';
            setTimeout(() => { status.style.display = 'none'; }, 1000);
        }

        // --- ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ü‡∏•‡πå (‡πÅ‡∏¢‡∏Å‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å) ---
        function downloadFile() {
            const ticker = document.getElementById('tickerInput').value.replace(/\n/g, " ");
            const rows = document.querySelectorAll('#playlistTable tbody tr');
            let jsContentList = [];

            rows.forEach(row => {
                const type = row.querySelector('.type-select').value;
                const src = row.querySelector('.src-input').value.trim();
                const duration = row.querySelector('.dur-input').value;

                // ‡∏ï‡∏≠‡∏ô‡∏à‡∏∞‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå‡∏à‡∏£‡∏¥‡∏á ‡∏Ñ‡πà‡∏≠‡∏¢‡πÄ‡∏ä‡πá‡∏Ñ‡∏ß‡πà‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ‡∏ä‡∏∑‡πà‡∏≠‡πÑ‡∏ü‡∏•‡πå ‡∏´‡πâ‡∏≤‡∏°‡∏ß‡πà‡∏≤‡∏á
                if(src !== "") {
                    jsContentList.push(`    { type: '${type}', src: '${src}', duration: ${duration} }`);
                }
            });

            const fileContent = `// ‡πÑ‡∏ü‡∏•‡πå‡∏ô‡∏µ‡πâ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥ (‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÄ‡∏°‡∏∑‡πà‡∏≠ ${new Date().toLocaleString('th-TH')})\nvar tickerText = "${ticker}";\n\nvar mediaList = [\n${jsContentList.join(',\n')}\n];`;

            const blob = new Blob([fileContent], { type: 'text/javascript' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = 'playlist.js';
            link.click();

            alert("‚úÖ ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ü‡∏•‡πå‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢!\n\nüëâ ‡∏ô‡∏≥‡πÑ‡∏ü‡∏•‡πå 'playlist.js' ‡πÑ‡∏õ‡∏ß‡∏≤‡∏á‡∏ó‡∏±‡∏ö‡πÑ‡∏ü‡∏•‡πå‡πÄ‡∏î‡∏¥‡∏°‡πÉ‡∏ô‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå SmartBoard ‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢‡∏Ñ‡∏£‡∏±‡∏ö");
        }
    </script>
</body>
</html>
